const chart=function(){let e=["January","February","March","April","May","June","July"],t=[];function n(){return Math.floor(256*Math.random()).toString()}return{getChartData:function(r,a){return e=[],t=[],fetch(`https://cors-anywhere.herokuapp.com/https://min-api.cryptocompare.com/data/histoday?fsym=${r}&tsym=USD&limit=6`).then(e=>e.json()).then(r=>{let c=[];r.Data.forEach(t=>{c.push(t.close),e.push(function(e){const t=new Date(1e3*e),n=t.getDate(),r=t.getMonth();return`${["January","February","March","April","May","June","July","August","September","October","November","December"][r]} ${n}`}(t.time))}),n(),n(),n(),t.push({label:a,backgroundColor:"transparent",borderColor:"rgba( 0, 0, 0, 0.7)",borderWidth:3,pointBackgroundColor:"#66ff66",pointRadius:5,pointHoverRadius:8,data:c}),function(){const n=document.getElementById("currency-chart").getContext("2d");new Chart(n,{type:"line",data:{labels:e,datasets:t},options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{scaleLabel:{display:!0,labelString:"Price in USD",fontSize:20}}],xAxes:[{scaleLabel:{display:!0,labelString:"Day",fontSize:20}}]}}})}()})}}}(),CurrencyTable=function(e){let t=0,n=[],r=["$","USD"];const a=[13.4,12.3,10.5,10.2,9.2,7.6,5.4,4.9,4.3,4,3.8,3.4,2.1,1.7,1.5,1.5,1.2,1.2,.9,.9],c=document.getElementById("currency-chart");function o(t){document.querySelectorAll(".fiat").forEach(e=>e.textContent=` (${r[1]})`),n=t;let o=document.createElement("tbody"),s=[];t.forEach((t,n)=>{s.push(t.symbol);let r=document.createElement("tr");r.innerHTML=`\n                    <td>${t.rank}</td>\n                    <td><span class="currency-name">${t.name}</span> <span class="currency-symbol"> ${t.symbol} </span></td>\n                    <td>${l(t.market_cap_usd)}</td>\n                    <td>${l(t.price_usd)}</td>\n                    <td>${a[n]}%</td>\n                    <td>${i(a[n])}</td>\n            `,r.style.cursor="pointer",o.appendChild(r),r.addEventListener("click",n=>{!function(e){let t=document.querySelectorAll("tr.active");for(let e=0;e<t.length;e++)t[e].classList.remove("active");"span"===e.target.nodeName.toLowerCase()?e.target.parentNode.parentNode.classList.add("active"):e.target.parentNode.classList.add("active")}(n),c.innerHTML="",e.chart.getChartData(t.symbol,t.name),c.scrollIntoView({behavior:"smooth"})})}),e.currencyTable.appendChild(o),e.getNews(s),e.currencySymbol=s}function l(e){let t=parseFloat(e);return t%1!=0&&t>1?(t=`${r[0]}${t.toFixed(2)}`).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"):t<1?`${r[0]}${t}`:(t=`${r[0]}${parseInt(t)}`).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}function i(e){let n=t*e/100;return t-=n,l(n)}return{buildTable:o,formatNum:l,calculateInvestment:i,submitForm:function(r){if(r.preventDefault(),""!==e.input.value){for(t=e.input.value;e.currencyTable.childNodes.length>1;)e.currencyTable.removeChild(e.currencyTable.lastChild);o(n)}}}};document.addEventListener("DOMContentLoaded",()=>{const e="https://min-api.cryptocompare.com/data/news/?categories=";let t=[];const n=5;let r=0,a=n;const c=document.querySelector(".currency-table"),o=document.querySelector(".invest-form"),l=document.querySelector(".invest-input"),i=document.querySelector(".news-table"),s=document.querySelector(".refresh-icon"),d=CurrencyTable({form:o,input:l,currencyTable:c,getNews:m,currencySymbols:t,chart:chart});function u(e){return fetch(e).then(e=>e.json())}function m(t){let c=t.join(",");s.children[0].classList.add("spin-animation"),setTimeout(function(){s.children[0].classList.remove("spin-animation")},500),fetchUrl=e.concat(c),u(fetchUrl).then(e=>(function(e){a>=5*n?(r=0,a=n):(r+=n,a+=n);let t=e.slice(r,a),c=document.createElement("tbody");null!==i&&(i.innerHTML=""),t.forEach(e=>{let t=document.createElement("tr");t.innerHTML=`\n            <td><a class="font-weight-bold" href="${e.url}">${e.title}</a> <p>${e.source}</p>\n            </td>\n            `,c.appendChild(t)}),i.appendChild(c)})(e))}o.addEventListener("submit",e=>(function(e){d.submitForm(e)})(e)),s.addEventListener("click",()=>m(t)),u("https://api.coinmarketcap.com/v1/ticker/?limit=20").then(e=>{d.buildTable(e),chart.getChartData("BTC","Bitcoin")})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoYXJ0LmpzIiwiY3VycmVuY3lUYWJsZS5qcyIsIm1haW4uanMiXSwibmFtZXMiOlsiY2hhcnQiLCJsYWJlbHMiLCJkYXRhc2V0cyIsImdldFJhbmRvbSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInRvU3RyaW5nIiwiZ2V0Q2hhcnREYXRhIiwiY3VyU3ltYm9sIiwiY3VyTmFtZSIsImZldGNoIiwidGhlbiIsInJlcyIsImpzb24iLCJjbG9zaW5nUHJpY2VzIiwiRGF0YSIsImZvckVhY2giLCJkIiwicHVzaCIsImNsb3NlIiwiZGF0ZVRpbWUiLCJkYXRlU3RyaW5nIiwiRGF0ZSIsImRheSIsImdldERhdGUiLCJtb250aEluZGV4IiwiZ2V0TW9udGgiLCJwYXJzZURhdGUiLCJ0aW1lIiwibGFiZWwiLCJiYWNrZ3JvdW5kQ29sb3IiLCJib3JkZXJDb2xvciIsImJvcmRlcldpZHRoIiwicG9pbnRCYWNrZ3JvdW5kQ29sb3IiLCJwb2ludFJhZGl1cyIsInBvaW50SG92ZXJSYWRpdXMiLCJkYXRhIiwiY3R4IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImdldENvbnRleHQiLCJDaGFydCIsInR5cGUiLCJvcHRpb25zIiwicmVzcG9uc2l2ZSIsIm1haW50YWluQXNwZWN0UmF0aW8iLCJzY2FsZXMiLCJ5QXhlcyIsInNjYWxlTGFiZWwiLCJkaXNwbGF5IiwibGFiZWxTdHJpbmciLCJmb250U2l6ZSIsInhBeGVzIiwiYnVpbGRDaGFydCIsIkN1cnJlbmN5VGFibGUiLCJnbG9iYWwiLCJpbnZlc3RBbW91bnQiLCJhbGxDdXJyZW5jaWVzIiwiZmlhdCIsImMyMEluZGV4IiwiY3VycmVuY3lDaGFydCIsImJ1aWxkVGFibGUiLCJjdXJyZW5jaWVzIiwicXVlcnlTZWxlY3RvckFsbCIsIml0ZW0iLCJ0ZXh0Q29udGVudCIsInRib2R5IiwiY3JlYXRlRWxlbWVudCIsImN1cnJTeW1ib2xzIiwiY3VyIiwiY29pbiIsInN5bWJvbCIsInRyIiwiaW5uZXJIVE1MIiwicmFuayIsIm5hbWUiLCJmb3JtYXROdW0iLCJtYXJrZXRfY2FwX3VzZCIsInByaWNlX3VzZCIsImNhbGN1bGF0ZUludmVzdG1lbnQiLCJzdHlsZSIsImN1cnNvciIsImFwcGVuZENoaWxkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJldmVudCIsImFsbEFjdGl2ZSIsImkiLCJsZW5ndGgiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0YXJnZXQiLCJub2RlTmFtZSIsInRvTG93ZXJDYXNlIiwicGFyZW50Tm9kZSIsImFkZCIsInNob3dhY3RpdmVSb3ciLCJzY3JvbGxJbnRvVmlldyIsImJlaGF2aW9yIiwiY3VycmVuY3lUYWJsZSIsImdldE5ld3MiLCJjdXJyZW5jeVN5bWJvbCIsInZhbHVlIiwibmV3TnVtIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJyZXBsYWNlIiwicGFyc2VJbnQiLCJhbW91bnQiLCJzdWJtaXRGb3JtIiwicHJldmVudERlZmF1bHQiLCJpbnB1dCIsImNoaWxkTm9kZXMiLCJyZW1vdmVDaGlsZCIsImxhc3RDaGlsZCIsIm5ld3NVcmwiLCJjdXJyZW5jeVN5bWJvbHMiLCJuZXdzTGltaXQiLCJmaXJzdEFydGljbGUiLCJsYXN0QXJ0aWNsZSIsInF1ZXJ5U2VsZWN0b3IiLCJmb3JtIiwibmV3c1RhYmxlIiwicmVmcmVzaEJ1dHRvbiIsIkN1cnJlbmN5IiwiZ2V0RGF0YSIsInVybCIsImN1cnJTdHJpbmciLCJqb2luIiwiY2hpbGRyZW4iLCJzZXRUaW1lb3V0IiwiZmV0Y2hVcmwiLCJjb25jYXQiLCJhcnRpY2xlcyIsImFydGljbGVzU2FtcGxlIiwic2xpY2UiLCJpbmZvIiwidGl0bGUiLCJzb3VyY2UiLCJzaG93TmV3cyJdLCJtYXBwaW5ncyI6IkFBQ0EsTUFBQUEsTUFBQSxXQUVBLElBQUFDLEdBQUEsVUFBQSxXQUFBLFFBQUEsUUFBQSxNQUFBLE9BQUEsUUFDQUMsS0E4RkEsU0FBQUMsSUFDQSxPQUFBQyxLQUFBQyxNQUFBLElBQUFELEtBQUFFLFVBQUFDLFdBSUEsT0FDQUMsYUFq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QUFBTSxTQUFBLEdBQUF4QyxVQUFBQyxPQUFBLG1CQUNBLEtBRUF5QyxTQUFBaEIsRUFBQWlCLE9BQUFMLEdBRUFGLEVBQUFNLFVBQUF4SCxLQUFBQyxJQTVDQSxTQUFBeUgsR0FHQWQsR0FBQSxFQUFBRixHQUNBQyxFQUFBLEVBQ0FDLEVBQUFGLElBRUFDLEdBQUFELEVBQ0FFLEdBQUFGLEdBRUEsSUFBQWlCLEVBQUFELEVBQUFFLE1BQUFqQixFQUFBQyxHQUNBckQsRUFBQTVCLFNBQUE2QixjQUFBLFNBSUEsT0FBQXVELElBQ0FBLEVBQUFqRCxVQUFBLElBR0E2RCxFQUFBdEgsUUFBQXdILElBQ0EsSUFBQWhFLEVBQUFsQyxTQUFBNkIsY0FBQSxNQUNBSyxFQUFBQyxpRUFDQStELEVBQUFWLFFBQUFVLEVBQUFDLGdCQUFBRCxFQUFBRSw4Q0FHQXhFLEVBQUFnQixZQUFBVixLQUVBa0QsRUFBQXhDLFlBQUFoQixJQWlCQXlFLENBQUEvSCxJQWpFQTZHLEVBQUF0QyxpQkFBQSxTQUFBQyxJQXFFQSxTQUFBQSxHQUNBd0MsRUFBQWYsV0FBQXpCLElBdEVBeUIsQ0FBQXpCLElBQ0F1QyxFQUFBeEMsaUJBQUEsUUFBQSxJQUFBaUIsRUFBQWdCLElBSUFTLEVBMUJBLHFEQTBCQWxILEtBQUFDLElBQ0FnSCxFQUFBL0QsV0FBQWpELEdBQ0FiLE1BQUFRLGFBQUEsTUFBQSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuY29uc3QgY2hhcnQgPSAoIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICBsZXQgbGFiZWxzICAgPSBbXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLCBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLCBcIkp1bHlcIl07XHJcbiAgICBsZXQgZGF0YXNldHMgPSBbXTtcclxuICAgIFxyXG5cclxuICAgIGZ1bmN0aW9uIGdldENoYXJ0RGF0YSAoIGN1clN5bWJvbCwgY3VyTmFtZSApe1xyXG5cclxuICAgICAgICBsYWJlbHMgICA9IFtdO1xyXG4gICAgICAgIGRhdGFzZXRzID0gW107XHJcblxyXG4gICAgICAgIHJldHVybiBmZXRjaCggYGh0dHBzOi8vY29ycy1hbnl3aGVyZS5oZXJva3VhcHAuY29tL2h0dHBzOi8vbWluLWFwaS5jcnlwdG9jb21wYXJlLmNvbS9kYXRhL2hpc3RvZGF5P2ZzeW09JHtjdXJTeW1ib2x9JnRzeW09VVNEJmxpbWl0PTZgIClcclxuICAgICAgICAgICAgICAgIC50aGVuKCByZXMgPT4gcmVzLmpzb24oKSApXHJcbiAgICAgICAgICAgICAgICAudGhlbiggcmVzID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAvLyA9PT09PSBDaGVjayBmb3IgRW1wdHkgRGF0YSA9PT09PSAvL1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNsb3NpbmdQcmljZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICByZXMuRGF0YS5mb3JFYWNoKCBkID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2luZ1ByaWNlcy5wdXNoKCBkLmNsb3NlICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVscy5wdXNoKCBwYXJzZURhdGUoIGQudGltZSApIClcclxuICAgICAgICAgICAgICAgICAgICAgfSApXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxpbmVDb2xvciA9IGdldFJhbmRvbUNvbG9yKClcclxuICAgICAgICAgICAgICAgICAgICBkYXRhc2V0cy5wdXNoKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBjdXJOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICd0cmFuc3BhcmVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiAncmdiYSggMCwgMCwgMCwgMC43KScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlcldpZHRoOiAzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludEJhY2tncm91bmRDb2xvcjogJyM2NmZmNjYnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludFJhZGl1czogNSxcdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludEhvdmVyUmFkaXVzOiA4LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBjbG9zaW5nUHJpY2VzLFxyXG4gICAgICAgICAgICAgICAgICAgIH0gKVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgYnVpbGRDaGFydCgpO1xyXG4gICAgICAgICAgICAgICAgfSApXHJcbiAgICB9XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIHBhcnNlRGF0ZSggZGF0ZVRpbWUgKSB7XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGVTdHJpbmcgPSBuZXcgRGF0ZSggZGF0ZVRpbWUgKiAxMDAwICk7XHJcbiAgICAgICAgY29uc3QgbW9udGhOYW1lcyA9IFtcclxuICAgICAgICAgICAgXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLFxyXG4gICAgICAgICAgICBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLCBcIkp1bHlcIixcclxuICAgICAgICAgICAgXCJBdWd1c3RcIiwgXCJTZXB0ZW1iZXJcIiwgXCJPY3RvYmVyXCIsXHJcbiAgICAgICAgICAgIFwiTm92ZW1iZXJcIiwgXCJEZWNlbWJlclwiXHJcbiAgICAgICAgXTtcclxuICAgICAgICBjb25zdCBkYXkgPSBkYXRlU3RyaW5nLmdldERhdGUoKTtcclxuICAgICAgICBjb25zdCBtb250aEluZGV4ID0gZGF0ZVN0cmluZy5nZXRNb250aCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgcmV0dXJuIGAke21vbnRoTmFtZXNbbW9udGhJbmRleF19ICR7ZGF5fWA7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIGJ1aWxkQ2hhcnQoKSB7XHJcbiAgICAgICAgY29uc3QgY3R4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1cnJlbmN5LWNoYXJ0JykuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICBjb25zdCBjaGFydCA9IG5ldyBDaGFydChjdHgsIHtcclxuICAgICAgICAgICAgLy8gaGUgdHlwZSBvZiBjaGFydCB3ZSB3YW50IHRvIGNyZWF0ZVxyXG4gICAgICAgICAgICB0eXBlOiAnbGluZScsXHJcbiAgICBcclxuICAgICAgICAgICAgLy8gVGhlIGRhdGEgZm9yIG91ciBkYXRhc2V0XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGxhYmVscyxcclxuICAgICAgICAgICAgICAgIGRhdGFzZXRzXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICAgICAgLy8gQ29uZmlndXJhdGlvbiBvcHRpb25zIGdvIGhlcmVcclxuICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgcmVzcG9uc2l2ZTp0cnVlLFxyXG4gICAgICAgICAgICAgICAgbWFpbnRhaW5Bc3BlY3RSYXRpbzpmYWxzZSxcclxuICAgICAgICAgICAgICAgIHNjYWxlczoge1xyXG4gICAgICAgICAgICAgICAgICAgIHlBeGVzOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgc2NhbGVMYWJlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFN0cmluZzogJ1ByaWNlIGluIFVTRCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiAyMFxyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgICAgIHhBeGVzOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FsZUxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFN0cmluZzogJ0RheScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IDIwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IClcclxuICAgIH1cclxuXHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0UmFuZG9tQ29sb3IoKSB7XHJcbiAgICAgICAgcmV0dXJuIGByZ2JhKCR7Z2V0UmFuZG9tKCl9LCAke2dldFJhbmRvbSgpfSwgJHtnZXRSYW5kb20oKX0sIDAuOClgO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRSYW5kb20oKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NikudG9TdHJpbmcoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBnZXRDaGFydERhdGFcclxuICAgIH1cclxufSApKClcclxuIiwiY29uc3QgQ3VycmVuY3lUYWJsZSA9IGZ1bmN0aW9uICggZ2xvYmFsICkge1xyXG4gICAgXHJcbiAgICBsZXQgaW52ZXN0QW1vdW50ICAgID0gMDtcclxuICAgIGxldCBhbGxDdXJyZW5jaWVzICAgPSBbXTtcclxuICAgIGxldCBmaWF0ICAgICAgICAgICAgPSBbJyQnLCAnVVNEJ107XHJcbiAgICBjb25zdCBjMjBJbmRleCAgICAgID0gWyAxMy40LCAxMi4zLCAxMC41LCAxMC4yLCA5LjIsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNy42LCA1LjQsIDQuOSwgNC4zLCA0LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDMuOCwgMy40LCAyLjEsIDEuNywgMS41LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEuNSwgMS4yLCAxLjIsIDAuOSwgMC45IF07XHJcblxyXG4gICAgY29uc3QgY3VycmVuY3lDaGFydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAnY3VycmVuY3ktY2hhcnQnICk7XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge2N1cnJlbmNpZXN9IEFycmF5IGFycmF5IG9mIGN1cnJlbmNpZXMgZGF0YSAgXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGJ1aWxkVGFibGUoIGN1cnJlbmNpZXMgKSB7XHJcbiAgICAgICAgLy8gQWRkIGZpYXQgdG8gdGhlYWRcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmlhdCcpLmZvckVhY2goKGl0ZW0pID0+IGl0ZW0udGV4dENvbnRlbnQgPSBgICgke2ZpYXRbMV19KWApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGFsbEN1cnJlbmNpZXMgPSBjdXJyZW5jaWVzO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCB0Ym9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICd0Ym9keScgKTtcclxuICAgICAgICBsZXQgY3VyclN5bWJvbHMgPSBbXTtcclxuICAgICAgICBjdXJyZW5jaWVzLmZvckVhY2goICggY3VyLCBjb2luICkgPT4ge1xyXG4gICAgICAgICAgICBjdXJyU3ltYm9scy5wdXNoKGN1ci5zeW1ib2wpO1xyXG4gICAgICAgICAgICBsZXQgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAndHInICk7XHJcbiAgICAgICAgICAgIHRyLmlubmVySFRNTCA9IGBcclxuICAgICAgICAgICAgICAgICAgICA8dGQ+JHsgY3VyLnJhbmsgfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRkPjxzcGFuIGNsYXNzPVwiY3VycmVuY3ktbmFtZVwiPiR7IGN1ci5uYW1lfTwvc3Bhbj4gPHNwYW4gY2xhc3M9XCJjdXJyZW5jeS1zeW1ib2xcIj4gJHtjdXIuc3ltYm9sfSA8L3NwYW4+PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+JHsgZm9ybWF0TnVtKCBjdXIubWFya2V0X2NhcF91c2QgKSB9PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+JHsgZm9ybWF0TnVtKCBjdXIucHJpY2VfdXNkICkgfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRkPiR7IGMyMEluZGV4W2NvaW5dIH0lPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+JHsgY2FsY3VsYXRlSW52ZXN0bWVudCggYzIwSW5kZXhbY29pbl0gKSB9PC90ZD5cclxuICAgICAgICAgICAgYDtcclxuICAgICAgICAgICAgdHIuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG4gICAgICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZCggdHIgKSAgXHJcblxyXG4gICAgICAgICAgICB0ci5hZGRFdmVudExpc3RlbmVyKCAnY2xpY2snLCAoIGUgKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzaG93YWN0aXZlUm93KCBlICk7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW5jeUNoYXJ0LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgZ2xvYmFsLmNoYXJ0LmdldENoYXJ0RGF0YSggY3VyLnN5bWJvbCwgY3VyLm5hbWUgKTtcclxuICAgICAgICAgICAgICAgIGN1cnJlbmN5Q2hhcnQuc2Nyb2xsSW50b1ZpZXcoIHsgYmVoYXZpb3I6ICdzbW9vdGgnIH0gKTtcclxuICAgICAgICAgICAgIH0gKSAgICBcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZ2xvYmFsLmN1cnJlbmN5VGFibGUuYXBwZW5kQ2hpbGQoIHRib2R5ICk7XHJcbiAgICAgICAgZ2xvYmFsLmdldE5ld3MoY3VyclN5bWJvbHMpO1xyXG4gICAgICAgIGdsb2JhbC5jdXJyZW5jeVN5bWJvbCA9IGN1cnJTeW1ib2xzOyAgIFxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gc2hvd2FjdGl2ZVJvdyggZXZlbnQgKSB7XHJcbiAgICAgICAgbGV0IGFsbEFjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoICd0ci5hY3RpdmUnICk7XHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDAgOyBpIDwgYWxsQWN0aXZlLmxlbmd0aCA7IGkgKysgKXtcclxuICAgICAgICAgICAgYWxsQWN0aXZlW2ldLmNsYXNzTGlzdC5yZW1vdmUoICdhY3RpdmUnICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCggJ2FjdGl2ZScgKTtcclxuICAgICAgICBldmVudC50YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3NwYW4nXHJcbiAgICAgICAgICAgID8gIGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCggJ2FjdGl2ZScgKVxyXG4gICAgICAgICAgICA6ICBldmVudC50YXJnZXQucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCAnYWN0aXZlJyApO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHt2YWx1ZX0gTnVtYmVyIGZyb20gY2VsbERhdGFcclxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IEZvcm1hdHRlZCB3aXRoIGNvbW1hcyBhbmQgZmlhdCBzeW1ib2wuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGZvcm1hdE51bSggdmFsdWUgKSB7XHJcbiAgICAgICAgbGV0IG5ld051bSA9IHBhcnNlRmxvYXQoIHZhbHVlICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIGZsb2F0XHJcbiAgICAgICAgaWYgKG5ld051bSAlIDEgIT09IDAgJiYgbmV3TnVtID4gMSkge1xyXG4gICAgICAgICAgICAvLyBBZGQgZmlhdCBjdXJyZW5jeSBzeW1ib2wgJFxyXG4gICAgICAgICAgICAvLyBJZiBwcmljZSBpcyBvdmVyIDEsIGxpbWl0IGRlY2ltYWxzIHRvIHR3byBwbGFjZXNcclxuICAgICAgICAgICAgbmV3TnVtID0gYCR7ZmlhdFswXX0ke25ld051bS50b0ZpeGVkKDIpfWA7XHJcbiAgICAgICAgICAgIC8vIEFkZCBjb21tYSBhZnRlciBldmVyeSB0aHJlZSBudW1iZXJzXHJcbiAgICAgICAgICAgIHJldHVybiBuZXdOdW0gPSBuZXdOdW0ucmVwbGFjZSgvKFxcZCkoPz0oXFxkXFxkXFxkKSsoPyFcXGQpKS9nLCBcIiQxLFwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG5ld051bSA8IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ld051bSA9IGAke2ZpYXRbMF19JHtuZXdOdW19YDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBJZiBtYXJrZXQgY2FwLCBubyBkZWNpbWFsIHBsYWNlXHJcbiAgICAgICAgICAgIG5ld051bSA9IGAke2ZpYXRbMF19JHtwYXJzZUludChuZXdOdW0pfWA7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXdOdW0gPSBuZXdOdW0ucmVwbGFjZSgvKFxcZCkoPz0oXFxkXFxkXFxkKSsoPyFcXGQpKS9nLCBcIiQxLFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9IFxyXG5cclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0ge3ZhbHVlfSBOdW1iZXIgY3VycmVuY3kncyBpbmRleCBwZXJjZW50YWdlXHJcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlSW52ZXN0bWVudCggdmFsdWUgKSB7XHJcbiAgICAgICAgLy8gPT09PT0gTmVlZCB0byBmaWd1cmUgb3V0IHRoZSBjYWxjdWxhdGlvbnMgaGVyZSA9PT09PSAvL1xyXG4gICAgICAgIGxldCBhbW91bnQgPSBpbnZlc3RBbW91bnQgKiB2YWx1ZSAvIDEwMDtcclxuICAgICAgICBpbnZlc3RBbW91bnQgPSBpbnZlc3RBbW91bnQgLSBhbW91bnQ7XHJcbiAgICAgICAgcmV0dXJuIGZvcm1hdE51bSggYW1vdW50ICk7IFxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBzdWJtaXRGb3JtKCBlICkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBpZiggZ2xvYmFsLmlucHV0LnZhbHVlICE9PSAnJyApIHtcclxuICAgICAgICAgICAgaW52ZXN0QW1vdW50ID0gZ2xvYmFsLmlucHV0LnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgLy8gPT09PT0gUmVtb3ZlIHRhYmxlIGJvZHkgYW5kIHJlLXJlbmRlciA9PT09PSAvL1xyXG4gICAgICAgICAgICB3aGlsZSAoZ2xvYmFsLmN1cnJlbmN5VGFibGUuY2hpbGROb2Rlcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBnbG9iYWwuY3VycmVuY3lUYWJsZS5yZW1vdmVDaGlsZChnbG9iYWwuY3VycmVuY3lUYWJsZS5sYXN0Q2hpbGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJ1aWxkVGFibGUoIGFsbEN1cnJlbmNpZXMgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgYnVpbGRUYWJsZSxcclxuICAgICAgICBmb3JtYXROdW0sIFxyXG4gICAgICAgIGNhbGN1bGF0ZUludmVzdG1lbnQsXHJcbiAgICAgICAgc3VibWl0Rm9ybVxyXG4gICAgfVxyXG5cclxufSIsImRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xyXG5cclxuICAgIC8vID09PT09IEdMT0JBTFMgPT09PT0gLy9cclxuICAgIFxyXG5cclxuICAgIGNvbnN0IGMyMFVybCAgPSAnaHR0cHM6Ly9hcGkuY29pbm1hcmtldGNhcC5jb20vdjEvdGlja2VyLz9saW1pdD0yMCc7XHJcbiAgICBjb25zdCBuZXdzVXJsID0gJ2h0dHBzOi8vbWluLWFwaS5jcnlwdG9jb21wYXJlLmNvbS9kYXRhL25ld3MvP2NhdGVnb3JpZXM9JztcclxuICAgIGxldCBjdXJyZW5jeVN5bWJvbHMgPSBbXTtcclxuXHJcbiAgICAvLyBudW1iZXIgb2YgbmV3cyBhcnRpY2xlcyB0byBzaG93XHJcbiAgICBjb25zdCBuZXdzTGltaXQgPSA1O1xyXG4gICAgbGV0IGZpcnN0QXJ0aWNsZSA9IDA7XHJcbiAgICBsZXQgbGFzdEFydGljbGUgPSBuZXdzTGltaXQ7XHJcblxyXG4gICAgLy8gPT09PT0gUHV0IGFsbCBET00gdGFyZ2V0dGluZyBoZXJlID09PT09IC8vXHJcbiAgICBjb25zdCBjdXJyZW5jeVRhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvciggJy5jdXJyZW5jeS10YWJsZScgKTtcclxuICAgIGNvbnN0IGZvcm0gICAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCAnLmludmVzdC1mb3JtJyApO1xyXG4gICAgY29uc3QgaW5wdXQgICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoICcuaW52ZXN0LWlucHV0JyApO1xyXG4gICAgY29uc3QgbmV3c1RhYmxlICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoICcubmV3cy10YWJsZScgKTtcclxuICAgIGNvbnN0IHJlZnJlc2hCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCAnLnJlZnJlc2gtaWNvbicgKTtcclxuXHJcblxyXG4gICAgLy8gPT09PT0gdGhpcyB2YXJpYWJsZSBob2xkcyBhbGwgdGhlIGZ1bmN0aW9ucyBmb3IgY3VycmVuY3kgdGFibGUgPT09PT0gLy9cclxuICAgIGNvbnN0IEN1cnJlbmN5ID0gQ3VycmVuY3lUYWJsZSggeyBmb3JtLCBpbnB1dCwgY3VycmVuY3lUYWJsZSwgZ2V0TmV3cywgY3VycmVuY3lTeW1ib2xzLCBjaGFydCB9ICk7XHJcblxyXG4gICAgLy8gPT09PT0gRE9NIExpc3RlbmVycyA9PT09PSAvLyBcclxuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lciggJ3N1Ym1pdCcsICggZSApID0+IHN1Ym1pdEZvcm0oIGUgKSApO1xyXG4gICAgcmVmcmVzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCAnY2xpY2snLCAoKSA9PiBnZXROZXdzKCBjdXJyZW5jeVN5bWJvbHMgKSApXHJcblxyXG5cclxuXHJcbiAgICBnZXREYXRhKGMyMFVybCkudGhlbiggcmVzID0+IHtcclxuICAgICAgICBDdXJyZW5jeS5idWlsZFRhYmxlKCByZXMgKTtcclxuICAgICAgICBjaGFydC5nZXRDaGFydERhdGEoICdCVEMnLCAnQml0Y29pbicgKTtcclxuICAgIH0gKVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHt1cmx9IFN0cmluZyAgdXJsIHN0cmluZ1xyXG4gICAgICogQHJldHVybnMgeyBwcm9taXNlIH0gXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldERhdGEoIHVybCApIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goIHVybCApXHJcbiAgICAgICAgICAgICAgICAudGhlbiggcmVzID0+IHJlcy5qc29uKCkgKVxyXG4gICAgfTsgXHJcblxyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBzaG93TmV3cyhhcnRpY2xlcykge1xyXG4gICAgICAgIC8vIElmIHVzZXIgcmVmcmVzaGVzIG5ld3MsIHB1bGwgbmV3IGJhdGNoXHJcbiAgICAgICAgLy8gV2hlbiB1c2VyIGN5Y2xlcyA1IHRpbWVzLCBzdGFydCBhZ2FpblxyXG4gICAgICAgIGlmIChsYXN0QXJ0aWNsZSA+PSBuZXdzTGltaXQgKiA1KSB7XHJcbiAgICAgICAgICAgIGZpcnN0QXJ0aWNsZSA9IDA7XHJcbiAgICAgICAgICAgIGxhc3RBcnRpY2xlID0gbmV3c0xpbWl0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZpcnN0QXJ0aWNsZSArPSBuZXdzTGltaXQ7XHJcbiAgICAgICAgICAgIGxhc3RBcnRpY2xlICs9IG5ld3NMaW1pdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGFydGljbGVzU2FtcGxlID0gYXJ0aWNsZXMuc2xpY2UoZmlyc3RBcnRpY2xlLCBsYXN0QXJ0aWNsZSk7ICBcclxuICAgICAgICBsZXQgdGJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAndGJvZHknICk7XHJcbiBcclxuICAgICAgICAvLyBpZiBuZXdzdGFibGUgaXMgYWxyZWFkeSBwcmVzZW50LCBjbGVhciBiZWZvcmVcclxuICAgICAgICAvLyBhcHBlbmRpbmdcclxuICAgICAgICBpZiAobmV3c1RhYmxlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIG5ld3NUYWJsZS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICB9XHJcbiBcclxuICAgICAgICBhcnRpY2xlc1NhbXBsZS5mb3JFYWNoKChpbmZvKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICd0cicgKTtcclxuICAgICAgICAgICAgdHIuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICAgICA8dGQ+PGEgY2xhc3M9XCJmb250LXdlaWdodC1ib2xkXCIgaHJlZj1cIiR7aW5mby51cmx9XCI+JHtpbmZvLnRpdGxlfTwvYT4gPHA+JHtpbmZvLnNvdXJjZX08L3A+XHJcbiAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgIGA7XHJcbiAgICAgICAgICAgIHRib2R5LmFwcGVuZENoaWxkKCB0ciApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgbmV3c1RhYmxlLmFwcGVuZENoaWxkKCB0Ym9keSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiBcclxuICAgICAqIGNvbnN0cnVjdCBuZXdzIGJhc2VkIG9uIHRvcCAyMCBjcnlwdG9cclxuICAgICAqIEBwYXJhbSB7Y3VyclN5bWJvbH0gQXJyYXkgY3VycmVuY3lzeW1ib2xzXHJcbiAgICAgKiBlZzogWydCVEMnLCAnRVRIJ11cclxuICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXROZXdzKGN1cnJTeW1ib2xzKSB7XHJcbiAgICAgICAgbGV0IGN1cnJTdHJpbmcgPSBjdXJyU3ltYm9scy5qb2luKFwiLFwiKTtcclxuICAgICAgICByZWZyZXNoQnV0dG9uLmNoaWxkcmVuWzBdLmNsYXNzTGlzdC5hZGQoJ3NwaW4tYW5pbWF0aW9uJyk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICBcdCAgICByZWZyZXNoQnV0dG9uLmNoaWxkcmVuWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ3NwaW4tYW5pbWF0aW9uJyk7XHJcbiAgICAgICAgICAgIH0sIDUwMCk7XHJcblxyXG4gICAgICAgIGZldGNoVXJsID0gbmV3c1VybC5jb25jYXQoY3VyclN0cmluZyk7XHJcblxyXG4gICAgICAgIGdldERhdGEoZmV0Y2hVcmwpLnRoZW4ocmVzID0+IHNob3dOZXdzKHJlcykpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBzdWJtaXRGb3JtKCBlICkge1xyXG4gICAgICAgIEN1cnJlbmN5LnN1Ym1pdEZvcm0oIGUgKTtcclxuICAgIH1cclxufSApXHJcbiJdfQ==
